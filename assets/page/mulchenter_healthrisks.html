<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: Wood Dust Health Risks</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="/assets/css/health_risks.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="antialiased">
    <div class="min-vh-100">
        <header class="bg-white shadow-sm">
            <div class="container-fluid py-4 py-lg-5 px-4 px-sm-5 px-lg-6"> 
                <h1 class="h3 fw-bold lh-sm text-dark">Wood Dust: From Occupational Hazard to Community Concern</h1>
                <p class="mt-2 small text-secondary">An interactive analysis of the health risks, community impact, and regulatory oversight of airborne wood particulates.</p>
            </div>
        </header>

        <main class="container-fluid py-4 px-4 px-sm-5 px-lg-6"> 
            <nav class="d-flex flex-wrap gap-2 mb-4" id="navigation">
                <button data-target="overview" class="nav-button active btn btn-light btn-sm fw-medium border border-secondary-subtle">Overview</button>
                <button data-target="health-risks" class="nav-button btn btn-light btn-sm fw-medium border border-secondary-subtle">Health Risks</button>
                <button data-target="community-impact" class="nav-button btn btn-light btn-sm fw-medium border border-secondary-subtle">Community Impact</button>
                <button data-target="regulatory-landscape" class="nav-button btn btn-light btn-sm fw-medium border border-secondary-subtle">Regulatory Landscape</button>
            </nav>

            <div id="content-container">
                <section id="overview" class="content-section active">
                    <h2 class="h4 fw-semibold mb-3 text-dark">Key Findings at a Glance</h2>
                    <p class="mb-4 text-secondary">This section provides a high-level summary of the most critical information regarding wood dust. It serves as an introduction to its classification as a carcinogen and highlights the primary health concerns identified in scientific literature, setting the context for the more detailed sections that follow.</p>
                    
                    <div class="row g-4"> 
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="bg-white p-4 rounded-3 shadow-sm">
                                <h3 class="fw-semibold h5 text-dark">Official Classification</h3>
                                <p class="mt-2 h1 fw-bold custom-text-brown">Group 1</p>
                                <p class="mt-2 text-secondary">Wood dust is classified as a "known human carcinogen" by the International Agency for Research on Cancer (IARC) and the U.S. National Toxicology Program (NTP).</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="bg-white p-4 rounded-3 shadow-sm">
                                <h3 class="fw-semibold h5 text-dark">Primary Cancer Risk</h3>
                                <p class="mt-2 h2 fw-bold custom-text-brown">Sino-nasal Cancers</p>
                                <p class="mt-2 text-secondary">The strongest and most consistent evidence links wood dust exposure to cancers of the nasal cavity and paranasal sinuses. Other cancers like lung cancer have also been studied, but the link is less definitive.</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="bg-white p-4 rounded-3 shadow-sm">
                                <h3 class="fw-semibold h5 text-dark">Beyond Cancer</h3>
                                <p class="mt-2 h2 fw-bold custom-text-brown">Respiratory Issues</p>
                                <p class="mt-2 text-secondary">Exposure can also lead to non-cancerous health problems, including asthma, bronchitis, dermatitis, and other allergic reactions. These are often the primary complaints from affected communities.</p>
                            </div>
                        </div>
                    </div>
                    
                     <div class="mt-4 bg-white p-4 rounded-3 shadow-sm">
                        <h3 class="fw-semibold h5 text-center text-dark mb-4">Primary Cancers Associated with Wood Dust Exposure</h3>
                         <div class="chart-container custom-h-lg">
                             <canvas id="cancerTypesChart"></canvas>
                         </div>
                    </div>
                </section>

                <section id="health-risks" class="content-section">
                    <h2 class="h4 fw-semibold mb-3 text-dark">Understanding the Carcinogenic Risks</h2>
                    <p class="mb-4 text-secondary">This section delves into the scientific evidence linking wood dust to cancer. The interactive chart below allows you to explore how the risk of developing sino-nasal cancer varies significantly across different industries and exposure levels. This highlights that not all wood dust exposure carries the same level of risk, with factors like wood type and work processes playing a crucial role.</p>
                    <div class="bg-white p-4 rounded-3 shadow-sm">
                        <h3 class="fw-semibold h5 text-center text-dark mb-2">Relative Risk of Sino-nasal Cancer by Industry</h3>
                        <p class="text-center small text-secondary mb-4">Odds Ratios (OR) indicate the increased likelihood of disease. An OR of 10 means a 10-fold increased risk.</p>
                        <div class="d-flex justify-content-center gap-2 mb-4">
                            <button id="filter-all" class="filter-btn custom-bg-brown text-white btn btn-sm rounded-2">All Industries</button>
                            <button id="filter-high" class="filter-btn bg-light text-secondary btn btn-sm rounded-2">High-Risk Only</button>
                        </div>
                        <div class="chart-container custom-h-xl">
                            <canvas id="riskByIndustryChart"></canvas>
                        </div>
                    </div>
                </section>

                <section id="community-impact" class="content-section">
                    <h2 class="h4 fw-semibold mb-3 text-dark">From Factory Floor to Residential Neighborhoods</h2>
                    <p class="mb-4 text-secondary">While most research focuses on occupational settings, communities living near facilities like mulch production plants also face exposure to airborne wood dust. This section illustrates how "fugitive dust" escapes from these sites and becomes a nuisance and potential health concern for nearby residents, leading to formal complaints and regulatory scrutiny.</p>
                    <div class="bg-white p-4 rounded-3 shadow-sm">
                        <h3 class="fw-semibold h5 text-center text-dark mb-4">The Pathway of Fugitive Dust Exposure</h3>
                        
                        <div class="d-flex flex-column flex-md-row align-items-center justify-content-around gap-4 text-center">
                            
                            <div class="pathway-item position-relative">
                                <div class="custom-w-8 custom-h-8 custom-bg-light rounded-circle d-flex align-items-center justify-content-center p-3">
                                    <span class="fw-bold custom-text-brown">SOURCE</span>
                                </div>
                                <p class="mt-2 fw-semibold">Mulch Piles & Grinding</p>
                                <div class="pathway-tooltip position-absolute bottom-100 mb-2 custom-tooltip-w bg-dark text-white small rounded py-2 px-3 opacity-0 invisible transition-opacity duration-300">
                                    Large, open-air piles of wood chips and the dust generated from grinding operations.
                                </div>
                            </div>
                            
                            <div class="custom-arrow-size text-secondary fw-light d-none d-md-block">&rarr;</div>
                            <div class="custom-arrow-size text-secondary fw-light d-md-none">&darr;</div>
                            
                            <div class="pathway-item position-relative">
                                <div class="custom-w-8 custom-h-8 custom-bg-light rounded-circle d-flex align-items-center justify-content-center p-3">
                                    <span class="fw-bold custom-text-brown">PATHWAY</span>
                                </div>
                                <p class="mt-2 fw-semibold">Wind & Air Currents</p>
                                <div class="pathway-tooltip position-absolute bottom-100 mb-2 custom-tooltip-w bg-dark text-white small rounded py-2 px-3 opacity-0 invisible transition-opacity duration-300">
                                    Wind picks up fine wood particles and carries them off-site into the surrounding environment.
                                </div>
                            </div>
                            
                             <div class="custom-arrow-size text-secondary fw-light d-none d-md-block">&rarr;</div>
                            <div class="custom-arrow-size text-secondary fw-light d-md-none">&darr;</div>
                            
                            <div class="pathway-item position-relative">
                                <div class="custom-w-8 custom-h-8 custom-bg-light rounded-circle d-flex align-items-center justify-content-center p-3">
                                    <span class="fw-bold custom-text-brown">RECEPTOR</span>
                                </div>
                                <p class="mt-2 fw-semibold">Nearby Homes & Residents</p>
                                <div class="pathway-tooltip position-absolute bottom-100 mb-2 custom-tooltip-w bg-dark text-white small rounded py-2 px-3 opacity-0 invisible transition-opacity duration-300">
                                    Residents inhale particulates, and dust settles on cars, homes, and property, leading to health and nuisance complaints.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 bg-white p-4 rounded-3 shadow-sm">
                        <h3 class="fw-semibold h5 text-center text-dark mb-4">Documented Resident Complaints</h3>
                        <div id="complaints-slider" class="position-relative custom-h-slider">
                        </div>
                    </div>
                </section>

                <section id="regulatory-landscape" class="content-section">
                    <h2 class="h4 fw-semibold mb-3 text-dark">Oversight and Enforcement</h2>
                    <p class="mb-4 text-secondary">State environmental agencies are responsible for regulating air quality and addressing public nuisances. This section outlines the typical process that follows a resident complaint about fugitive dust. Click on each step to understand its role in the regulatory framework, which aims to balance industrial activity with community well-being.</p>
                    <div class="bg-white p-4 rounded-3 shadow-sm">
                        <h3 class="fw-semibold h5 text-center text-dark mb-4">Typical Complaint and Response Process</h3>
                        
                        <div class="d-flex flex-column flex-md-row align-items-start justify-content-center gap-3 text-center small" id="flowchart">
                            <div class="flowchart-step p-3 border border-2 border-secondary-subtle rounded-3 bg-white flex-grow-1" data-id="complaint">
                                <p class="fw-bold">1. Resident Complaint</p>
                            </div>
                            <div class="d-flex align-items-center h5 text-secondary mx-2 mt-2">&rarr;</div>
                            <div class="flowchart-step p-3 border border-2 border-secondary-subtle rounded-3 bg-white flex-grow-1" data-id="investigation">
                                <p class="fw-bold">2. Agency Investigation</p>
                            </div>
                            <div class="d-flex align-items-center h5 text-secondary mx-2 mt-2">&rarr;</div>
                            <div class="flowchart-step p-3 border border-2 border-secondary-subtle rounded-3 bg-white flex-grow-1" data-id="violation">
                                <p class="fw-bold">3. Notice of Violation</p>
                            </div>
                            <div class="d-flex align-items-center h5 text-secondary mx-2 mt-2">&rarr;</div>
                            <div class="flowchart-step p-3 border border-2 border-secondary-subtle rounded-3 bg-white flex-grow-1" data-id="action">
                                <p class="fw-bold">4. Corrective Action</p>
                            </div>
                        </div>
                        <div id="flowchart-details" class="mt-4 p-3 bg-light rounded-3 custom-h-details">
                            <p class="text-secondary">Click a step above to see details.</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        // ... (Keep the original JavaScript largely intact, as it handles logic, not CSS) ...
        document.addEventListener('DOMContentLoaded', function () {
            const navigation = document.getElementById('navigation');
            const contentContainer = document.getElementById('content-container');
            const sections = contentContainer.querySelectorAll('.content-section');
            const navButtons = navigation.querySelectorAll('.nav-button');
            let cancerTypesChartInstance, riskByIndustryChartInstance;

            const complaintData = [
                { quote: "A layer of brown dust covers everything outside... my car, my windows, my patio furniture. I'm constantly cleaning.", source: "Resident A, Public Hearing" },
                { quote: "My son's asthma has gotten significantly worse since the mulch plant expanded its operations. We can't let him play outside on windy days.", source: "Resident B, Complaint Filing" },
                { quote: "The smell is one thing, but it's the visible dust cloud that worries me. What are we breathing in every day?", source: "Resident C, News Report" },
                { quote: "We've had to replace our air filters twice as often. The HVAC technician said he's never seen so much fine particulate matter.", source: "Resident D, Community Meeting" }
            ];

            const flowchartData = {
                complaint: {
                    title: "Resident Complaint",
                    text: "A resident documents the issue (e.g., photos, videos, logs of dates/times) and files a formal complaint with the state's environmental protection agency or local air quality board, citing nuisance, property damage, or health concerns."
                },
                investigation: {
                    title: "Agency Investigation",
                    text: "An inspector visits the site and surrounding neighborhood to verify the complaint. They may conduct air quality monitoring, review the facility's dust control plan, and document visible evidence of dust leaving the property line."
                },
                violation: {
                    title: "Notice of Violation (NOV)",
                    text: "If the investigation confirms that the facility is violating regulations (e.g., 'failure to control fugitive dust' or 'creating a public nuisance'), the agency issues a formal Notice of Violation, detailing the specific infractions observed."
                },
                action: {
                    title: "Corrective Action & Enforcement",
                    text: "The facility is required to submit and implement a corrective action plan, which could include using water sprays, covering piles, or installing windbreaks. Failure to comply can result in fines, penalties, or further legal action."
                }
            };

            const riskChartData = {
                labels: ['Cabinet/Furniture Making', 'Sawmills', 'Carpentry/Joinery', 'Plywood/Particleboard', 'Forestry/Logging', 'Pulp/Paper Mills'],
                datasets: [{
                    label: 'Odds Ratio for Sino-nasal Cancer',
                    data: [45.5, 12.8, 11.3, 5.1, 2.5, 1.2],
                    backgroundColor: ['#A67B5B', '#A67B5B', '#A67B5B', '#C8A98F', '#C8A98F', '#EFEBE7'],
                    borderColor: '#FFFFFF',
                    borderWidth: 1
                }]
            };

            const cancerTypesData = {
                labels: ['Sino-nasal adenocarcinoma', 'Other Sino-nasal cancers', 'Nasopharyngeal', 'Laryngeal'],
                datasets: [{
                    label: 'Associated Cancer Types',
                    data: [65, 20, 10, 5],
                    backgroundColor: ['#A67B5B', '#C8A98F', '#E1D3C5', '#F5F1EC'],
                    hoverOffset: 4
                }]
            };

            function init() {
                setupNavigation();
                setupFlowchart();
                setupComplaintsSlider();
                createCancerTypesChart();
                createRiskByIndustryChart();
            }

            // NOTE: The class manipulation in JS needs slight updates:
            // Tailwind: 'bg-[#A67B5B]', 'text-white'
            // Custom: 'custom-bg-brown', 'text-white' (already defined in Bootstrap)

            function setupNavigation() {
                navigation.addEventListener('click', (e) => {
                    if (e.target.classList.contains('nav-button')) {
                        const targetId = e.target.dataset.target;
                        
                        navButtons.forEach(btn => btn.classList.remove('active'));
                        e.target.classList.add('active');

                        sections.forEach(section => {
                            section.classList.remove('active');
                            if (section.id === targetId) {
                                section.classList.add('active');
                            }
                        });
                    }
                });
            }

            function createCancerTypesChart() {
                const ctx = document.getElementById('cancerTypesChart').getContext('2d');
                if (cancerTypesChartInstance) {
                    cancerTypesChartInstance.destroy();
                }
                cancerTypesChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: cancerTypesData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed + '%';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    },
                });
            }

            function createRiskByIndustryChart(filter = 'all') {
                const ctx = document.getElementById('riskByIndustryChart').getContext('2d');
                if (riskByIndustryChartInstance) {
                    riskByIndustryChartInstance.destroy();
                }

                let filteredData = JSON.parse(JSON.stringify(riskChartData));
                if (filter === 'high') {
                    const highRiskIndices = filteredData.datasets[0].data.map((val, i) => val > 10 ? i : -1).filter(i => i !== -1);
                    filteredData.labels = highRiskIndices.map(i => filteredData.labels[i]);
                    filteredData.datasets.forEach(ds => {
                        ds.data = highRiskIndices.map(i => ds.data[i]);
                        ds.backgroundColor = highRiskIndices.map(i => ds.backgroundColor[i]);
                    });
                }

                riskByIndustryChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: filteredData,
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Odds Ratio (Increased Risk)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return ` Odds Ratio: ${context.raw}. An OR of ${context.raw} represents a ${context.raw}-fold increased risk compared to an unexposed population.`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            document.getElementById('filter-all').addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('custom-bg-brown', 'text-white');
                    btn.classList.add('bg-light', 'text-secondary'); // Bootstrap colors for inactive
                });
                e.target.classList.add('custom-bg-brown', 'text-white');
                e.target.classList.remove('bg-light', 'text-secondary');
                createRiskByIndustryChart('all');
            });

            document.getElementById('filter-high').addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('custom-bg-brown', 'text-white');
                    btn.classList.add('bg-light', 'text-secondary');
                });
                e.target.classList.add('custom-bg-brown', 'text-white');
                e.target.classList.remove('bg-light', 'text-secondary');
                createRiskByIndustryChart('high');
            });
            
            function setupComplaintsSlider() {
                const slider = document.getElementById('complaints-slider');
                let currentIndex = 0;

                function showComplaint(index) {
                    const complaint = complaintData[index];
                    slider.innerHTML = `
                        <div class="position-absolute top-0 bottom-0 start-0 end-0 d-flex flex-column align-items-center justify-content-center p-4 text-center transition-opacity duration-500 ease-in-out opacity-0" id="complaint-${index}">
                            <p class="text-secondary fst-italic">"${complaint.quote}"</p>
                            <p class="mt-2 small fw-semibold text-secondary">- ${complaint.source}</p>
                        </div>
                    `;
                    setTimeout(() => {
                         const el = document.getElementById(`complaint-${index}`);
                         if(el) el.style.opacity = 1;
                    }, 50);
                }

                function nextComplaint() {
                    currentIndex = (currentIndex + 1) % complaintData.length;
                    showComplaint(currentIndex);
                }

                showComplaint(currentIndex);
                setInterval(nextComplaint, 6000);
            }

            function setupFlowchart() {
                const flowchart = document.getElementById('flowchart');
                const detailsContainer = document.getElementById('flowchart-details');

                flowchart.addEventListener('click', (e) => {
                    const stepElement = e.target.closest('.flowchart-step');
                    if (stepElement) {
                        const stepId = stepElement.dataset.id;
                        const stepData = flowchartData[stepId];

                        flowchart.querySelectorAll('.flowchart-step').forEach(el => el.classList.remove('active'));
                        stepElement.classList.add('active');

                        detailsContainer.innerHTML = `
                            <h4 class="fw-bold h5 custom-text-brown">${stepData.title}</h4>
                            <p class="mt-2 text-secondary">${stepData.text}</p>
                        `;
                    }
                });
            }

            init();
        });
    </script>
</body>
</html>